#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <time.h>

int main() {
    pid_t pid;
    srand(time(NULL));
    pid = fork();

    if (pid < 0) {
        perror("Échec de fork");
        return 1;
    }

    if (pid == 0) {
        // Processus fils
        int temps = rand() % 5 + 1;

        printf("[fils] PID = %d | PPID = %d\n", getpid(), getppid());
        printf("[fils] Je m'endors pour %d secondes...\n", temps);
        sleep(temps);
        printf("[fils] Je suis réveillé !\n");
        printf("*** FIN du processus < %d > ***\n", getpid());
    } 
    else {
        // Processus père
        printf("[pere] PID = %d | PPID = %d\n", getpid(), getppid());
        printf("[pere] En attente du réveil de son fils...\n");

        wait(NULL);

        printf("[pere] Mon fils s'est réveillé !\n");
        printf("*** FIN du processus < %d > ***\n", getpid());
    }

    return 0;
}
